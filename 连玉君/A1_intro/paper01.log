-----------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\stata11\ado\personal\Net_course_A\A1_intro\paper01.log
  log type:  text
 opened on:  16 Mar 2010, 17:44:55

.       
.       
.   *- 《上市公司资本结构影响因素的实证分析》 
.   *- 2008.10.10
.       
.   *--------------
.   * -1- 数据处理
.   *--------------
.      use xtcs.dta, clear

.      tsset code year
       panel variable:  code (strongly balanced)
        time variable:  year, 1998 to 2004
                delta:  1 unit

.      xtdes

    code:  2, 4, ..., 600896                                 n =        438
    year:  1998, 1999, ..., 2004                             T =          7
           Delta(year) = 1 unit
           Span(year)  = 7 periods
           (code*year uniquely identifies each observation)

Distribution of T_i:   min      5%     25%       50%       75%     95%     max
                         7       7       7         7         7       7       7

     Freq.  Percent    Cum. |  Pattern
 ---------------------------+---------
      438    100.00  100.00 |  1111111
 ---------------------------+---------
      438    100.00         |  XXXXXXX

.      winsor tl, gen(tl_w) p(0.01)

.      winsor tobin, gen(tobin_w) p(0.01)

.          
.   *----------------
.   * -2- 基本统计量
.   *----------------
.      local xx "tl sl size ndts-tobin"

.      tabstat `xx', stat(mean sd min p50 max) format(%6.3f) c(s)

    variable |      mean        sd       min       p50       max
-------------+--------------------------------------------------
          tl |     0.440     0.165     0.008     0.443     0.924
          sl |     0.378     0.158     0.008     0.371     0.924
        size |    21.139     0.888    18.789    21.077    24.446
        ndts |     0.140     0.115     0.000     0.115     0.911
        tang |     0.467     0.163     0.016     0.463     0.968
         npr |     0.082     0.132    -0.981     0.062     0.962
        tshr |     0.366     0.153     0.024     0.360     1.000
       tobin |     1.583     0.594     0.865     1.425     8.099
----------------------------------------------------------------

.       
.   *--------------
.   * -3- 回归分析
.   *--------------  
.     *- Pooled OLS
.        reg tl size ndts tang npr tshr tobin, robust

Linear regression                                      Number of obs =    3066
                                                       F(  6,  3059) =  147.68
                                                       Prob > F      =  0.0000
                                                       R-squared     =  0.2535
                                                       Root MSE      =  .14287

------------------------------------------------------------------------------
             |               Robust
          tl |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        size |   .0398442   .0036526    10.91   0.000     .0326824     .047006
        ndts |  -.3550418   .0285515   -12.44   0.000    -.4110239   -.2990597
        tang |   .0470558   .0176914     2.66   0.008     .0123677    .0817439
         npr |  -.4226389   .0260572   -16.22   0.000    -.4737303   -.3715474
        tshr |   .0321371   .0185516     1.73   0.083    -.0042377     .068512
       tobin |  -.0330295   .0061229    -5.39   0.000    -.0450349   -.0210242
       _cons |  -.2995247   .0821974    -3.64   0.000    -.4606924    -.138357
------------------------------------------------------------------------------

.        est store ols

.     *- FE
.        xtreg tl size ndts tang npr tshr tobin, fe robust

Fixed-effects (within) regression               Number of obs      =      3066
Group variable: code                            Number of groups   =       438

R-sq:  within  = 0.4397                         Obs per group: min =         7
       between = 0.0321                                        avg =       7.0
       overall = 0.0706                                        max =         7

                                                F(6,437)           =    101.86
corr(u_i, Xb)  = -0.6550                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 438 clusters in code)
------------------------------------------------------------------------------
             |               Robust
          tl |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        size |    .159812   .0085364    18.72   0.000     .1430346    .1765894
        ndts |  -.0668162    .043829    -1.52   0.128    -.1529581    .0193257
        tang |    .074203   .0220466     3.37   0.001     .0308724    .1175337
         npr |  -.1712854   .0200056    -8.56   0.000    -.2106045   -.1319663
        tshr |  -.4765506   .0598204    -7.97   0.000    -.5941222   -.3589791
       tobin |  -.0041718   .0053107    -0.79   0.433    -.0146095    .0062659
       _cons |  -2.769054   .1708467   -16.21   0.000    -3.104838   -2.433271
-------------+----------------------------------------------------------------
     sigma_u |  .19166135
     sigma_e |  .07193802
         rho |  .87651675   (fraction of variance due to u_i)
------------------------------------------------------------------------------

.        est store fe

.     *- RE
.        xtreg tl size ndts tang npr tshr tobin, re robust

Random-effects GLS regression                   Number of obs      =      3066
Group variable: code                            Number of groups   =       438

R-sq:  within  = 0.4093                         Obs per group: min =         7
       between = 0.0806                                        avg =       7.0
       overall = 0.1388                                        max =         7

Random effects u_i ~ Gaussian                   Wald chi2(6)       =    615.86
corr(u_i, X)       = 0 (assumed)                Prob > chi2        =    0.0000

                                 (Std. Err. adjusted for 438 clusters in code)
------------------------------------------------------------------------------
             |               Robust
          tl |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        size |   .1059211   .0062863    16.85   0.000     .0936002    .1182421
        ndts |  -.2022948   .0467142    -4.33   0.000     -.293853   -.1107365
        tang |   .0751263    .021929     3.43   0.001     .0321463    .1181064
         npr |  -.2079506   .0206168   -10.09   0.000    -.2483588   -.1675424
        tshr |  -.1487213   .0390381    -3.81   0.000    -.2252344   -.0722081
       tobin |   -.016482   .0055894    -2.95   0.003    -.0274371   -.0055269
       _cons |  -1.708628   .1303439   -13.11   0.000    -1.964098   -1.453159
-------------+----------------------------------------------------------------
     sigma_u |  .11543266
     sigma_e |  .07193802
         rho |  .72026266   (fraction of variance due to u_i)
------------------------------------------------------------------------------

.        est store re    

.        
.     *- 呈现结果
.        local m "ols fe re"

.        esttab `m', mtitle(`m') compress nogap b(%6.3f)  ///
>               scalars(r2_a N F) star(* 0.1 ** 0.05 *** 0.01) 

-------------------------------------------------
                 (1)          (2)          (3)   
                 ols           fe           re   
-------------------------------------------------
size           0.040***     0.160***     0.106***
             (10.91)      (18.72)      (16.85)   
ndts          -0.355***    -0.067       -0.202***
            (-12.44)      (-1.52)      (-4.33)   
tang           0.047***     0.074***     0.075***
              (2.66)       (3.37)       (3.43)   
npr           -0.423***    -0.171***    -0.208***
            (-16.22)      (-8.56)     (-10.09)   
tshr           0.032*      -0.477***    -0.149***
              (1.73)      (-7.97)      (-3.81)   
tobin         -0.033***    -0.004       -0.016***
             (-5.39)      (-0.79)      (-2.95)   
_cons         -0.300***    -2.769***    -1.709***
             (-3.64)     (-16.21)     (-13.11)   
-------------------------------------------------
N               3066         3066         3066   
r2_a           0.252        0.439                
F            147.683      101.859                
-------------------------------------------------
t statistics in parentheses
* p<0.1, ** p<0.05, *** p<0.01

.     
.         *- 输出到 Excel 文档 
.        local m "ols fe re"

.        esttab `m' using R.csv, replace                  ///
>                   mtitle(`m') compress nogap b(%6.3f)       ///
>               scalars(r2_a N F) star(* 0.1 ** 0.05 *** 0.01) 
(output written to R.csv)

.                           
.   log close
      name:  <unnamed>
       log:  D:\stata11\ado\personal\Net_course_A\A1_intro\paper01.log
  log type:  text
 closed on:  16 Mar 2010, 17:45:05
-----------------------------------------------------------------------------------------
